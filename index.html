<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>E-Commerce Frontend</title>

        <!-- Critical performance optimization -->
        <link rel="preload" href="styles/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <link rel="preload" href="scripts/app.js" as="script">
        <link rel="preload" href="first.png" as="image">
        <link rel="preconnect" href="https://fakestoreapi.com" crossorigin>
        <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

        <!-- DNS prefetch for external resources -->
        <link rel="dns-prefetch" href="//fakestoreapi.com">
        <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
        
        <!-- Critical CSS inline -->
        <style>
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;margin:0;padding:0;opacity:1;transition:opacity .1s ease-in-out}
        .navbar{display:flex;align-items:center;justify-content:space-between;padding:20px;background:#c7a1b3;width:100%;margin:0}
        .hero{height:100vh;background:linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)),url('first.png') no-repeat center/cover;display:flex;align-items:center;justify-content:center;text-align:center;color:white;padding:20px}
        .hero-content h1{font-size:3rem;margin-bottom:20px}.hero-content p{font-size:1.5rem;margin-bottom:30px}
        .product-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px}
        img{transition:opacity .3s ease}
        </style>
        
        <!-- Non-critical CSS loaded asynchronously -->
        <link rel="preload" href="styles/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="styles/main.css"></noscript>
        
        <!-- Defer Font Awesome loading -->
        <link
            rel="preload"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'"
            integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"></noscript>
    </head>

    <body>
        <header>
            <div class="container">
                <div class="navbar">
                    <div class="logo">
                        <img src="logo2.png" width="50" height="50" alt="Logo" loading="lazy" onerror="this.src='placeholder.png'; this.onerror=null;">
                    </div>
                    <div class="hamburger" onclick="toggleMenu()">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <nav class="nav" id="nav">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="products.html">Product</a></li>
                            <li><a href="about.html">About</a></li>
                            <li><a href="contact.html">Contact us</a></li>
                        </ul>
                        <div class="right-nav">
                            <div class="search-bar">
                                <input
                                    type="text"
                                    placeholder="search for products"
                                />
                                <button type="submit">Search</button>
                            </div>
                            <div class="account">
                                <a href="login.html"
                                    ><i class="fa-solid fa-circle-user"></i
                                ></a>
                            </div>
                            <div class="cart">
                                <a href="cart.html">
                                    <img src="c.jpg" width="30" height="30" alt="Cart" loading="lazy" onerror="this.src='placeholder.png'; this.onerror=null;">
                                </a>
                                <span>0</span>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </header>
        <section class="hero">
            <div class="hero-content">
                <h1>Biggest Sale of the Year!</h1>
                <p>Up to 70% off on all products </p>
                <a href="#products" class="cta-button">Shop Now</a>
            </div>
        </section>
        <section class="products" id="products">
            <div class="container">
                <h2>Latest Products sales</h2>
                <div id="loadingMessage">Loading products...</div>
                <div id="errorMessage" style="display: none; color: red"></div>
                <div class="product-grid" id="productGrid"></div>

            </div>
        </section>

        <!-- Critical scripts loaded immediately -->
        <script src="scripts/cart-utils.js"></script>
        <script src="scripts/app.js"></script>
        
        <!-- Non-critical scripts deferred -->
        <script src="scripts/resource-optimizer.js" defer></script>
        <script src="scripts/lazy-loading.js" defer></script>
        <script src="scripts/performance-monitor.js" defer></script>
        <script src="scripts/image-optimizer.js" defer></script>
        <script src="scripts/products.js" defer></script>
        <script type="module" src="firebase-config.js" defer></script>
        <script>
            // Initialize performance monitoring with enhanced features
            document.addEventListener('DOMContentLoaded', function() {
                console.log('E-Commerce Website Loaded');
                
                // Initialize performance monitoring
                if (typeof PerformanceMonitor !== 'undefined') {
                    const performanceMonitor = new PerformanceMonitor();
                    window.performanceMonitor = performanceMonitor;
                    
                    // Auto-optimize after load
                    setTimeout(() => {
                        performanceMonitor.autoOptimize();
                    }, 2000);
                }
                
                // Initialize resource optimizer
                if (typeof ResourceOptimizer !== 'undefined') {
                    const resourceOptimizer = new ResourceOptimizer();
                    resourceOptimizer.inlineCriticalCSS();
                }
                
                // Initialize cart count
                if (typeof updateCartCount === 'function') {
                    updateCartCount();
                }
                
                // Initialize hamburger menu
                window.toggleMenu = function() {
                    const nav = document.getElementById('nav');
                    nav.classList.toggle('show');
                };
                
                // Add performance dashboard access
                window.openPerformanceDashboard = function() {
                    window.open('performance-dashboard.html', 'performance', 'width=1200,height=800');
                };
            });
            
            // Handle script loading errors
            window.addEventListener('error', function(e) {
                if (e.target.tagName === 'SCRIPT') {
                    console.error('Failed to load script:', e.target.src);
                }
            });
            
            // Service Worker registration for caching (if available)
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function() {
                    // Note: You can implement a service worker for additional caching
                    console.log('Service Worker support detected');
                });
            }
        </script>
    </body>
</html>
